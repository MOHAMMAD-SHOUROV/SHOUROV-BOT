// commands/oii.js
module.exports.config = {
  name: "oii",
  version: "1.0.2",
  permission: 2,
  credits: "shourov",
  prefix: false,
  description: "Send a series of styled messages (mention required).",
  category: "without prefix",
  usages: "[tag]",
  cooldowns: 5
};

module.exports.run = async function({ api, event, args, Users }) {
  try {
    const { threadID, messageID, mentions } = event;

    // get first mention id
    const mentionKeys = Object.keys(mentions || {});
    if (mentionKeys.length === 0) {
      return api.sendMessage("ржЖржкржирж┐ ржХрж╛ржЙржХрзЗ ржЯрзНржпрж╛ржЧ ржХрж░рзЗ ржПржЗ ржХржорж╛ржирзНржбржЯрж┐ ржЪрж╛рж▓рж╛рждрзЗ рж╣ржмрзЗред @ржорзНржпрж╛ржирж╢ржи ржХрж░рзБржиред", threadID, messageID);
    }
    const targetID = mentionKeys[0];
    const displayName = mentions[targetID] || (await Users.getNameUser(targetID));

    // build mention object required by API
    const mentionObject = [{ id: targetID, tag: displayName }];

    // array of captions/messages to send (taken & cleaned from your original)
    const messages = [
      "рж╕рзНржмрж░рзНржЧ ржЖржорж┐ ржЪрж╛ржЗ ржирж╛ ржХрж╛рж░ржг ржЖржорж┐ рждрзЛржорж╛ржХрзЗ ржкрзЗржпрж╝рзЗржЫрж┐\nрж╕рзНржмржкрзНржи ржЖржорж┐ ржжрзЗржЦрждрзЗ ржЪрж╛ржЗ ржирж╛ ржХрж╛рж░ржг рждрзБржорж┐ржЗ ржЖржорж╛рж░ рж╕рзНржмржкрзНржи",
      "ржЬрж╛ржи рждрзБржорж┐ ржПржд рж╕рзБржирзНржжрж░ ржХрзЗржи ржЖржорж┐ ржпрзЗ рждрзЛржорж╛ржпрж╝ ржирж╛ ржжрзЗржЦрзЗ ржерж╛ржХрждрзЗ ржкрж╛рж░рж┐ ржирж╛",
      "рждрзБржорж┐ ржпржжрж┐ ржЖржорж╛рж░ ржирж╛ рж╣ржУ рждрж╛рж╣рж▓рзЗ ржЖржорж┐ ржЖржорж╛рж░ ржПржЗ ржЬрзАржмржи рж░рж╛ржЦржм ржирж╛ ржХрж╛рж░ржг ржЖржорж┐ рждрзЛржорж╛ржХрзЗ ржЦрзБржм ржнрж╛рж▓рзЛржмрж╛рж╕рж┐",
      "ржпржЦржи ржерзЗржХрзЗ ржкрж░рзА рж╣рзЯрзЗ ржерж╛ржХрж╛ ржмрзЗржзрзЗ ржЧрзЗржЫрзЗ ржЖржорж╛рж░ ржЪрзЛржЦрзЗ, рждржЦржи ржерзЗржХрзЗ рждрзБржорж┐ ржЫрж╛рзЬрж╛ ржЖрж░ ржХрж┐ржЫрзБржЗ ржнрж╛рж▓рзЛ рж▓рж╛ржЧрзЗ ржирж╛",
      "рждрзЛржорж╛рж░ ржЪрж┐ржирзНрждрж╛ ржЖржорж╛рж░ ржоржи ржерзЗржХрзЗ ржХржЦржиржЗ ржпрж╛ржмрзЗ ржирж╛ ржХрж╛рж░ржг рждрзБржорж┐ ржЖржорж╛рж░ ржЪрж┐ржирзНрждрж╛рж░ ржЪрж┐ржирзНрждрж╛ржпрж╝ ржорж┐рж╢рзЗ ржЖржЫрзЛ",
      "ржЯржорзЗржЯрзЛ рж▓рж╛рж▓ ржХрж╛ржБржЪрж╛ ржорж░рж┐ржЪ ржЭрж╛рж▓ рждрзЛржорж╛рж░ ржмрзБржХрзЗрж░ ржорж╛ржЭрзЗ ржЪрзБржорзБ ржжрзЗржмрзЛ ржЖржорж┐ ржЪрж┐рж░ржХрж╛рж▓ ржЬрж╛ржи",
      "ржЬрж╛ржи рждрзЛржорж╛рж░ рж▓рж╛рж▓ рж▓рж╛рж▓ ржПржХ ржПржХржЯрж╛ ummmmmmmah ЁЯТЛ рждрзЛржорж╛рж░ ржЬржирзНржп ржЖржорж┐ ржкрж╛ржЧрж▓ рж╣рзЯрзЗ ржпрж╛ржмрзЛ ржЬрж╛ржи",
      "ржЖржорж┐ ржЦрзЗрждрзЗ ржкрж╛рж░рж┐ржирж╛ ржШрзБржорж╛ржЗрждрзЗ ржкрж╛рж░рж┐ржирж╛ ржХрж┐ржЫрзБ ржХрж░рждрзЗ ржкрж╛рж░рж┐ ржирж╛ рждрзЛржорж╛ржХрзЗ ржЫрж╛рзЬрж╛ ржЬрж╛ржи",
      "I Lo'Ve u Ja n рждрзЛржорж╛ржХрзЗ ржЫрж╛рзЬрж╛ ржмрж╛ржБржЪржмрзЛ ржирж╛ рждрзБржорж┐ рж╢рзБржзрзБ ржЖржорж╛рж░ ржЬрж╛ржи",
      "ржнрж╛рж▓ржмрж╛рж╕рж┐ ржнрж╛рж▓ржмрж╛рж╕рж┐ рж╢рзБржзрзБ рждрзЛржорж╛ржпрж╝ ржнрж╛рж▓рзЛржмрж╛рж╕рж┐ ржЬрж╛ржи",
      "рждрзБржорж┐ ржЖржорж╛ржпрж╝ ржХрж┐ ржХрж░рж▓рзЗ рждрзЛржорж╛ржХрзЗ ржЫрж╛рзЬрж╛ ржЖржорж┐ ржХрж┐ржЫрзБ ржмрзБржЭрж┐ржирж╛ ржХрзЗржи ржПржЗ ржоржи рж╢рзБржзрзБ ржЦрзЛржБржЬрзЗ рждрзЛржорж╛ржХрзЗ рж╕рж╛рж░рж╛ржХрзНрж╖ржг",
      "рждрзЛржорж╛рж░ рж╕рж╛ржерзЗ ржПржХржмрж╛рж░ ржХржерж╛ ржирж╛ ржмрж▓рж▓рзЗ ржЖржорж┐ ржпрзЗржи ржорж░рзЗ ржпрж╛ржЗ",
      "рждрзЛржорж╛ржХрзЗ ржжрзЗржЦрж▓рзЗ ржЖржорж╛рж░ ржПржд ржнрж╛рж▓рзЛ рж▓рж╛ржЧрзЗ ржХрзЗржи ржЬрж╛ржи ржЖржорж┐ ржХрж┐ржЫрзБржЗ рждрзЛ ржмрзБржЭрждрзЗ ржкрж╛рж░рж┐ ржирж╛",
      "рждрзБржорж┐ ржЖржорж╛рж░ рж╕ржмржХрж┐ржЫрзБ рж╣рзЯрзЗ ржЧрзЗржЫрзЛ, рждрзЛржорж╛рж░ ржЬржирзНржп рж╕ржмржЯрзБржХрзБ ржнрж╛рж▓ржмрж╛рж╕рж╛ржЗ ржЖржЫрзЗ",
      "рждрзЛржорж╛рж░ рж╕рж╛ржерзЗ ржерж╛ржХрж╛, рждрзЛржорж╛рж░ ржХржерж╛ рж╢рзЛржирж╛ тАФ ржПржЯрж╛ржЗ ржЖржорж╛рж░ рж╢рж╛ржирзНрждрж┐"
    ];

    // send an initial small header (optional)
    await api.sendMessage("ЁЭРТЁЭРЗЁЭРОЁЭРФЁЭРСЁЭРОЁЭРХ_ЁЭРБЁЭРОЁЭРУ", threadID);

    // send each message with a small delay so it looks natural
    messages.forEach((msg, idx) => {
      const delay = (idx + 1) * 1000; // 1s, 2s, 3s, ...
      setTimeout(() => {
        try {
          api.sendMessage({ body: `${msg} ${displayName}`, mentions: mentionObject }, threadID);
        } catch (e) {
          // ignore per-message failure
          console.error("oii send message error:", e && e.message);
        }
      }, delay);
    });

    // final message after all
    setTimeout(() => {
      try {
        api.sendMessage("ЁЯТЦ Mesage sequence finished.", threadID);
      } catch (e) {}
    }, (messages.length + 1) * 1000);

  } catch (err) {
    console.error("oii command error:", err && err.stack ? err.stack : err);
    try {
      return api.sendMessage("ржПржХржЯрж┐ рждрзНрж░рзБржЯрж┐ ржШржЯрзЗржЫрзЗ тАФ ржкрж░рзЗ ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред", event.threadID, event.messageID);
    } catch (e) {}
  }
};